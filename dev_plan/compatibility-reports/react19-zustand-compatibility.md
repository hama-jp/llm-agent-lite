# React 19 + Zustand äº’æ›æ€§ãƒ¬ãƒãƒ¼ãƒˆ

**èª¿æŸ»æ—¥**: 2025-08-21  
**èª¿æŸ»å†…å®¹**: React 19.1.x ã¨ Zustand v5 ã®äº’æ›æ€§ç¢ºèª

## ğŸ“‹ è¦ç´„

âœ… **çµè«–**: React 19.1.x ã¨ Zustand v5.0.8 ã¯å®Œå…¨ã«äº’æ›æ€§ãŒã‚ã‚Šã€å•é¡Œãªãä½¿ç”¨å¯èƒ½

- React 19ã¯2024å¹´12æœˆ5æ—¥ã«å®‰å®šç‰ˆãƒªãƒªãƒ¼ã‚¹
- Zustand v5.0.2ä»¥é™ã§React 19ã‚’å…¬å¼ã‚µãƒãƒ¼ãƒˆ
- ç¾åœ¨ã®æœ€æ–°ç‰ˆï¼ˆ2025å¹´8æœˆæ™‚ç‚¹ï¼‰: React 19.1.xã€Zustand v5.0.8

## ğŸ”§ æ¨å¥¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³çµ„ã¿åˆã‚ã›

### âœ… æ¨å¥¨æ§‹æˆï¼ˆ2025å¹´8æœˆæ™‚ç‚¹ï¼‰
```json
{
  "react": "^19.1.0",
  "react-dom": "^19.1.0", 
  "zustand": "^5.0.8"
}
```

### âš ï¸ éæ¨å¥¨ã ãŒå‹•ä½œã™ã‚‹æ§‹æˆ
```json
{
  "react": "^19.1.0",
  "react-dom": "^19.1.0",
  "zustand": "^4.x"
}
```
â€» peer dependencyè­¦å‘ŠãŒå‡ºã‚‹ãŒå‹•ä½œã¯ã™ã‚‹

## ğŸš¨ æ—¢çŸ¥ã®å•é¡Œã¨å¯¾ç­–

### 1. "Maximum update depth exceeded" ã‚¨ãƒ©ãƒ¼
**åŸå› **: v5ã§ä¸å®‰å®šãªã‚»ãƒ¬ã‚¯ã‚¿ãŒè‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
**å¯¾ç­–**: 
```javascript
import { useShallow } from 'zustand/shallow';
const data = useStore(useShallow(s => ({ a: s.a, b: s.b })));
```

### 2. npm "ERESOLVE" ç«¶åˆã‚¨ãƒ©ãƒ¼
**åŸå› **: v5.0.0-v5.0.1ã®peer dependencyå•é¡Œ
**å¯¾ç­–**: v5.0.2ä»¥é™ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰

### 3. TypeScript/JSXãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼
**åŸå› **: `.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã§JSXã‚’ä½¿ç”¨
**å¯¾ç­–**: `.tsx`æ‹¡å¼µå­ã‚’ä½¿ç”¨

## ğŸ”„ v4ã‹ã‚‰v5ã¸ã®ç§»è¡Œæ‰‹é †

1. **v4ã®æœ€æ–°ç‰ˆã«æ›´æ–°**
   ```bash
   npm i zustand@^4.5.6
   ```

2. **éæ¨å¥¨APIã®å‰Šé™¤**
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   - `subscribeWithSelector`ãƒã‚§ãƒ¼ãƒ³
   - ãã®ä»–ã®éæ¨å¥¨æ©Ÿèƒ½

3. **v5ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰**
   ```bash
   npm i zustand@^5.0.8
   ```

4. **APIã®æ›´æ–°**
   - ã‚«ã‚¹ã‚¿ãƒ ç­‰ä¾¡é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯`createWithEqualityFn`ã«å¤‰æ›´
   - ã¾ãŸã¯`useShallow`ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

5. **ä¸è¦ãªä¾å­˜é–¢ä¿‚å‰Šé™¤**
   - `use-sync-external-store`ã‚’æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹å ´åˆã¯å‰Šé™¤
   - React 19ã«ãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè£…æ¸ˆã¿

## âœ¨ React 19ã®æ–°æ©Ÿèƒ½ã¨ã®é–¢ä¿‚

- **Concurrent Rendering**: Zustandã‚¹ãƒˆã‚¢ã¯å½±éŸ¿ãªã—
- **Server Components**: è¿½åŠ ä½œæ¥­ä¸è¦
- **Actions**: Zustandã¨ä½µç”¨å¯èƒ½
- **æ–°ã—ã„`<form>`æ©Ÿèƒ½**: äº’æ›æ€§å•é¡Œãªã—

## ğŸ¯ æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®æ¨å¥¨äº‹é …

1. **ç¾åœ¨ã®React 19.1.0ã¯ç¶™ç¶šä½¿ç”¨**
2. **Zustand v5.0.8ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
3. **useShallowã®æ´»ç”¨ã§ã‚»ãƒ¬ã‚¯ã‚¿æœ€é©åŒ–**
4. **TypeScriptãƒ•ã‚¡ã‚¤ãƒ«ã¯`.tsx`æ‹¡å¼µå­ä½¿ç”¨**

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [React 19 Release Notes](https://react.dev/blog/2024/12/05/react-19)
- [Zustand v5 Release Notes](https://github.com/pmndrs/zustand/releases)
- [Zustand v5.0.2 Discussion](https://github.com/pmndrs/zustand/discussions/2840)
- [Context + React 19 use() Discussion](https://github.com/pmndrs/zustand/discussions/2955)

## ğŸ” èª¿æŸ»çµæœ

**äº’æ›æ€§**: âœ… å®Œå…¨å¯¾å¿œ  
**ç§»è¡Œé›£æ˜“åº¦**: ğŸŸ¢ ä½ã„  
**ãƒªã‚¹ã‚¯**: ğŸŸ¢ æœ€å°é™  
**æ¨å¥¨åº¦**: ğŸŸ¢ å¼·ãæ¨å¥¨

---

*ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯2025å¹´8æœˆ21æ—¥æ™‚ç‚¹ã®æƒ…å ±ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚æœ€æ–°æƒ…å ±ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚*